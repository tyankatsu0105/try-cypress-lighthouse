language: node_js
node_js:
  - 11

dist: trusty
sudo: false
cache: 
  yarn: true
  directories:
    # we also need to cache folder with Cypress binary
    - ~/.cache

addons:
  apt:
    packages:
      # Ubuntu 16+ does not install this dependency by default, so we need to install it ourselves
      - libgconf-2-4

branches:
  only:
    - master

stages:
  - name: Unit Test
  - name: E2E Test

before_script:
  - yarn start --silent &

jobs:
  include:
    - stage: Unit Test
      script: yarn test:unit
    - stage: E2E Test
      script: yarn test:e2e